ФИО: Изюмова Анастасия Витальевна

Предмет: Обработка и генерация изображений

Задача: Детекция аномалий

## Структура проекта
```
├── core                      <- Основной модуль.
    │   └── ae.py       <- Автоэнкодер.
    │   └── callback.py   <- Callback для логирования того, как на данном этапе обучения получается реконструировать изображения.
    │   └── dataset.py   <- Класс датасета.
    │   └── transforms.py   <- Трансформы для трейна и теста.
    
├── src
   │   └── data/dataset_splitter.py     <- Модуль со скриптами препроцессинга данных перед обучением (разбиение на подвыборки).
   │   └── test.py       <- Скрипт для получения итоговых метрик обученной модели на тесте.
   │   └── threshold_selector.py       <- Скрипт подбора трешхолда-отсечки по классам.
   │   └── train.py       <- Скрипт обучения модели.
```

## Эксперимент
### Краткое описание: обучить автоэнкодер и получить метрики TPR и TNR > 0.91

## Запуск
1. Скачайте датасет и поместите его в папку data/external/
2. Запустите пайплайн командой ```dvc repro```

## Модель
[Кастомный автоэнкодер на свертках](core/ae.py)

### Гиперпараметры
- optimizer: Adam
- lr: 0.004
- weight_decay: 1e-5
- batch_size: 16
- img_size: 32
- num_epochs: 25

## Лоссы
### Train
![image](https://github.com/starminalush/itmo-processing-and-generating-images-2023/assets/103132748/7cff82f7-8398-499c-8568-adf1f64acf55)

### Validation
![image](https://github.com/starminalush/itmo-processing-and-generating-images-2023/assets/103132748/d9e0ac7f-8753-4a80-8af6-82f0fefd5bf9)


## Подбор трешхолда для отсечки по классам
Не стала обучать деревья, просто визуализировала лоссы и выбрала примерно тот, где визуально есть большой перелом по MSE
![image](https://github.com/starminalush/itmo-processing-and-generating-images-2023/assets/103132748/7e9639b9-2021-47a5-a21c-0826b1808bae)

## Метрики
| TPR | TNR|
|---|---|
|0.902|0.91|


## Пример реконструкций изображений
![image](https://github.com/starminalush/itmo-processing-and-generating-images-2023/assets/103132748/e0554828-d937-47a9-987a-a29518a7ff3a)

## Вывод
Не совсем удалось побить бейзлайн. Перебирала архитектуры(пробовала VAE, добавляла и убавляла слои в текущем), меняла optimizer и количество эпох при обучении, но по итогу метрики +- растут только при очень точном подборе аугментаций.

